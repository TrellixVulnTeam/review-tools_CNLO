#!/bin/sh
set -e

exe=
args=
case "$1" in
    pep8|pyflakes3)
        exe="$1"
        ;;
    pylint3|pylint)
        exe="$1"
        # for now, only errors
        args="-E --disable=no-member"
        ;;
    *)
        echo "run-helper pep8|pyflakes3|pylint3|pylint"
        exit 1
        ;;
esac

echo "= $exe ="
for i in ./reviewtools/*py \
         ./reviewtools/tests/*py \
         ./bin/snap-review \
         ./bin/create-snap-declaration \
         ./bin/snap-updates-available \
         ./bin/snap-check-* ; do
    if echo "$i" | grep -q 'snap-check-notices' ; then
        continue  # shell
    fi
    echo "Checking $i"
    "$exe" $args "$i"
done
