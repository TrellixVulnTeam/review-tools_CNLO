= Test --seen-db updated =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-1.db' --store-db='./tests/test-store-1.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-1.db' --store-db='./tests/test-store-1.db'...

= Test multiple USNs with --seen-db updated =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...

= Test --seen-db updated, new subject says only was built =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-unittest-3.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-unittest-3.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected build packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-5501-1/


= Test --seen-db updated new subject says contains and was built =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-1.db' --store-db='./tests/test-store-unittest-3.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-unittest-3.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains and was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3606-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3606-1

In addition, the following lists new USNs for affected build packages in
each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3606-1/
 * https://ubuntu.com/security/notices/USN-5501-1/


= Test previous USNs not reported with --seen-db updated =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-2.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r21 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3606-1

Revision r22 (i386; channels: stable, candidate, beta)
 * libtiff5: 3606-1

Revision r23 (amd64; channels: edge)
 * libtiff5: 3606-1

Revision r24 (i386; channels: edge)
 * libtiff5: 3606-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-2.db'...

= Test up to date with --seen-db updated =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

= Test real world =
Emptying seen.db
== one USN affects snap ==
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-1.db' --store-db='./tests/test-store-1.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-1.db' --store-db='./tests/test-store-1.db'...

== two USNs affect snap ==
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3606-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3606-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3606-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3606-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...

== no USNs affect snap (snap updated) ==
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

== two USNs affect snap (snap reverted) ==
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-1.db'...

== no USNs affect snap (snap updated again) ==
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-2.db' --store-db='./tests/test-store-3.db'...

= Test --seen-db for ubuntu-budgie-welcome =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-budgie-1.db' --store-db='./tests/test-store-budgie.db'...
From: Snap Store <noreply@canonical.com>
To: packaging@ubuntubudgie.org
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: ubuntu-budgie-welcome contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: candidate, beta)
 * curl: 3598-1
 * libcurl3-gnutls: 3598-1
 * libicu55: 3610-1
 * libssl1.0.0: 3611-1, 3628-1
 * libtiff5: 3602-1, 3606-1
 * libwayland-client0: 3622-1
 * libwayland-cursor0: 3622-1
 * libwayland-server0: 3622-1

Revision r12 (i386; channels: candidate, beta)
 * curl: 3598-1
 * libcurl3-gnutls: 3598-1
 * libicu55: 3610-1
 * libssl1.0.0: 3611-1, 3628-1
 * libtiff5: 3602-1, 3606-1
 * libwayland-client0: 3622-1
 * libwayland-cursor0: 3622-1
 * libwayland-server0: 3622-1

Revision r43 (i386; channels: stable, stable/ubuntu-18.04)
 * libssl1.0.0: 3628-1

Revision r44 (amd64; channels: stable, stable/ubuntu-18.04)
 * libssl1.0.0: 3628-1

Revision r45 (amd64; channels: edge)
 * libssl1.0.0: 3628-1

Revision r46 (i386; channels: edge)
 * libssl1.0.0: 3628-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3598-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/
 * https://ubuntu.com/security/notices/USN-3610-1/
 * https://ubuntu.com/security/notices/USN-3611-1/
 * https://ubuntu.com/security/notices/USN-3622-1/
 * https://ubuntu.com/security/notices/USN-3628-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-budgie-2.db' --store-db='./tests/test-store-budgie.db'...
From: Snap Store <noreply@canonical.com>
To: packaging@ubuntubudgie.org
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: ubuntu-budgie-welcome contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: candidate, beta)
 * gir1.2-javascriptcoregtk-4.0: 3635-1
 * gir1.2-webkit2-4.0: 3635-1
 * libjavascriptcoregtk-4.0-18: 3635-1
 * libwebkit2gtk-4.0-37: 3635-1

Revision r12 (i386; channels: candidate, beta)
 * gir1.2-javascriptcoregtk-4.0: 3635-1
 * gir1.2-webkit2-4.0: 3635-1
 * libjavascriptcoregtk-4.0-18: 3635-1
 * libwebkit2gtk-4.0-37: 3635-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3635-1/


= Test --seen-db updated for test-xenial and test-bionic =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-os-release.db' --store-db='./tests/test-store-os-release.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: test-xenial contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r12 (i386; channels: stable, beta)
 * python-requests: 3790-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3790-1/

From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: test-bionic contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r12 (i386; channels: stable, beta)
 * python-requests: 3790-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3790-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-os-release.db' --store-db='./tests/test-store-os-release.db'...

= Test --seen-db updated for linux-generic-bbb =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb built from outdated Ubuntu kernel

A scan of this snap shows that it was built using sources based on a kernel
from the Ubuntu archive that has since received security updates. The
following lists new USNs for the Ubuntu kernel that the snap is based on in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * linux-image-generic: 3848-1, 3879-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3848-1/
 * https://ubuntu.com/security/notices/USN-3879-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel.db' --store-db='./tests/test-store-kernel.db'...

= Test --seen-db updated for linux-generic-bbb and build-pkgs =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb built from outdated Ubuntu kernel and with outdated Ubuntu packages

A scan of this snap shows that it was built using sources based on a kernel
from the Ubuntu archive that has since received security updates. The
following lists new USNs for the Ubuntu kernel that the snap is based on in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * linux-image-generic: 3848-1, 3879-1

In addition, the following lists new USNs for affected build packages in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * snapcraft: 5501-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3848-1/
 * https://ubuntu.com/security/notices/USN-3879-1/
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...

= Test --seen-db updated for linux-generic-bbb and only build pkgs in
second USN =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb built from outdated Ubuntu kernel

A scan of this snap shows that it was built using sources based on a kernel
from the Ubuntu archive that has since received security updates. The
following lists new USNs for the Ubuntu kernel that the snap is based on in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * linux-image-generic: 3848-1, 3879-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3848-1/
 * https://ubuntu.com/security/notices/USN-3879-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected build packages in each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * snapcraft: 5501-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...

= Test --seen-db updated for linux-generic-bbb and both kernel and
build pkgs in second USN=
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-reduced.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb built from outdated Ubuntu kernel

A scan of this snap shows that it was built using sources based on a kernel
from the Ubuntu archive that has since received security updates. The
following lists new USNs for the Ubuntu kernel that the snap is based on in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * linux-image-generic: 3879-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3879-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb built from outdated Ubuntu kernel and with outdated Ubuntu packages

A scan of this snap shows that it was built using sources based on a kernel
from the Ubuntu archive that has since received security updates. The
following lists new USNs for the Ubuntu kernel that the snap is based on in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * linux-image-generic: 3848-1

In addition, the following lists new USNs for affected build packages in
each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * snapcraft: 5501-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3848-1/
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...

= Test --seen-db updated for build-pkgs only =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected build packages in each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * snapcraft: 5501-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --store-db='./tests/test-store-kernel.db'...

= Test --seen-db updated for build-pkgs and staged packages =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...
From: Snap Store <noreply@canonical.com>
To: foo@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: linux-generic-bbb was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected build packages in each snap revision:

Revision r12 (armhf; channels: stable, beta)
 * snapcraft: 5501-1

Updating the snap's git tree, adjusting the version in the snapcraft.yaml
to match that of the Ubuntu kernel this snap is based on and rebuilding the
snap should pull in the new security updates and resolve this.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-kernel.db'...

= Test unkown release and missing usn release =
Emptying seen.db
Running: snap-updates-available --seen-db='<tmpfile>' --usn-db='./tests/test-usn-os-release-dne.db' --store-db='./tests/test-store-os-release-dne.db'...

Emptying seen.db
Running: snap-updates-available --usn-db='./tests/test-usn-budgie-2.db' --snap='./tests/test-snapcraft-manifest_0_amd64.snap'
{
  "libssl1.0.0": [
    "3611-1",
    "3628-1"
  ],
  "openssl": [
    "3611-1",
    "3628-1"
  ]
}

Running: snap-updates-available --usn-db='./tests/test-usn-core-with-dpkg-list.db' --snap='./tests/test-core_16-2.37.2_amd64.snap'
{
  "libc-bin": [
    "3323-1",
    "3534-1"
  ],
  "multiarch-support": [
    "3323-1",
    "3534-1"
  ]
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-core-with-dpkg-list.db' --snap='./tests/test-core_16-2.37.2_amd64.snap'
{
  "libc-bin": {
    "3323-1": [
      "CVE-2017-1000366"
    ],
    "3534-1": [
      "CVE-2017-1000408",
      "CVE-2017-1000409",
      "CVE-2017-15670",
      "CVE-2017-15804",
      "CVE-2017-16997",
      "CVE-2017-17426",
      "CVE-2018-1000001"
    ]
  },
  "multiarch-support": {
    "3323-1": [
      "CVE-2017-1000366"
    ],
    "3534-1": [
      "CVE-2017-1000408",
      "CVE-2017-1000409",
      "CVE-2017-15670",
      "CVE-2017-15804",
      "CVE-2017-16997",
      "CVE-2017-17426",
      "CVE-2018-1000001"
    ]
  }
}

Running: snap-updates-available --usn-db='./tests/test-usn-core-with-dpkg-list.db' --snap='./tests/test-dpkg-list-app_1.0_amd64.snap'
{
  "libc-bin": [
    "3323-1",
    "3534-1"
  ],
  "multiarch-support": [
    "3323-1",
    "3534-1"
  ]
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-core-with-dpkg-list.db' --snap='./tests/test-dpkg-list-app_1.0_amd64.snap'
{
  "libc-bin": {
    "3323-1": [
      "CVE-2017-1000366"
    ],
    "3534-1": [
      "CVE-2017-1000408",
      "CVE-2017-1000409",
      "CVE-2017-15670",
      "CVE-2017-15804",
      "CVE-2017-16997",
      "CVE-2017-17426",
      "CVE-2018-1000001"
    ]
  },
  "multiarch-support": {
    "3323-1": [
      "CVE-2017-1000366"
    ],
    "3534-1": [
      "CVE-2017-1000408",
      "CVE-2017-1000409",
      "CVE-2017-15670",
      "CVE-2017-15804",
      "CVE-2017-16997",
      "CVE-2017-17426",
      "CVE-2018-1000001"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel.db' --snap='./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap'
{
  "linux-image-gke": {
    "4489-1": [
      "CVE-2020-14386"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --snap='./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap'
{
  "linux-image-gke": {
    "4489-1": [
      "CVE-2020-14386"
    ]
  },
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --snap='./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs.db' --snap='./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel.db' --snap='./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap'
{
  "linux-image-generic": {
    "3848-1": [
      "CVE-2017-18174",
      "CVE-2018-12896",
      "CVE-2018-18690",
      "CVE-2018-18710"
    ],
    "3879-1": [
      "CVE-2018-10883",
      "CVE-2018-16862",
      "CVE-2018-19407",
      "CVE-2018-19824",
      "CVE-2018-20169"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --snap='./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap'
{
  "linux-image-generic": {
    "3848-1": [
      "CVE-2017-18174",
      "CVE-2018-12896",
      "CVE-2018-18690",
      "CVE-2018-18710"
    ],
    "3879-1": [
      "CVE-2018-10883",
      "CVE-2018-16862",
      "CVE-2018-19407",
      "CVE-2018-19824",
      "CVE-2018-20169"
    ]
  },
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --snap='./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs.db' --snap='./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel.db' --snap='./tests/pc-kernel_4.15.0-44.46_i386.snap'
{
  "linux-image-generic": {
    "3871-2": [
      "https://launchpad.net/bugs/1813663",
      "https://launchpad.net/bugs/1813727"
    ],
    "4489-1": [
      "CVE-2020-14386"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --snap='./tests/pc-kernel_4.15.0-44.46_i386.snap'
{
  "linux-image-generic": {
    "3871-2": [
      "https://launchpad.net/bugs/1813663",
      "https://launchpad.net/bugs/1813727"
    ],
    "4489-1": [
      "CVE-2020-14386"
    ]
  },
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --snap='./tests/pc-kernel_4.15.0-44.46_i386.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs.db' --snap='./tests/pc-kernel_4.15.0-44.46_i386.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel.db' --snap='./tests/pc-kernel_4.4.0-141.167_amd64.snap'
{
  "linux-image-generic": {
    "3879-1": [
      "CVE-2018-10883",
      "CVE-2018-16862",
      "CVE-2018-19407",
      "CVE-2018-19824",
      "CVE-2018-20169"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-kernel-and-build-pkgs.db' --snap='./tests/pc-kernel_4.4.0-141.167_amd64.snap'
{
  "linux-image-generic": {
    "3879-1": [
      "CVE-2018-10883",
      "CVE-2018-16862",
      "CVE-2018-19407",
      "CVE-2018-19824",
      "CVE-2018-20169"
    ]
  },
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --snap='./tests/pc-kernel_4.4.0-141.167_amd64.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-build-pkgs.db' --snap='./tests/pc-kernel_4.4.0-141.167_amd64.snap'
{
  "snapcraft": {
    "5501-1": [
      "CVE-2020-9999"
    ]
  }
}

Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-1.db' --store-db='./tests/test-store-unittest-bad-1.db'
WARN: 1ad: required field 'revisions' not found
ERROR: Errors encountered when scanning store entries
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-unittest-1.db'
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains and was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r15 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r16 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r17 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

In addition, the following lists new USNs for affected build packages in
each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r13 (amd64; channels: edge)
 * snapcraft: 5501-1

Revision r14 (i386; channels: edge)
 * snapcraft: 5501-1

Revision r15 (amd64; channels: edge)
 * snapcraft: 5501-1

Revision r16 (i386; channels: edge)
 * snapcraft: 5501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-unittest-2.db'
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r13 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r14 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r15 (amd64; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r16 (i386; channels: edge)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-build-pkgs-only.db' --store-db='./tests/test-store-unittest-1.db'
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected build packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r13 (amd64; channels: edge)
 * snapcraft: 5501-1

Revision r14 (i386; channels: edge)
 * snapcraft: 5501-1

Revision r15 (amd64; channels: edge)
 * snapcraft: 5501-1

Revision r16 (i386; channels: edge)
 * snapcraft: 5501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-build-pkgs.db' --store-db='./tests/test-store-unittest-3.db'
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains and was built with outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

In addition, the following lists new USNs for affected build packages in
each snap revision:

Revision r11 (amd64; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Revision r12 (i386; channels: stable, candidate, beta)
 * snapcraft: 5501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/
 * https://ubuntu.com/security/notices/USN-5501-1/


Running: snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices_0.1_amd64.snap'

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices_0.1_amd64.snap'

Running: snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-needed_0.1_amd64.snap'
{
  "libreoffice-style-tango": [
    "4102-1"
  ],
  "uno-libs3": [
    "4102-1"
  ]
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-needed_0.1_amd64.snap'
{
  "libreoffice-style-tango": {
    "4102-1": [
      "CVE-2019-9850",
      "CVE-2019-9851",
      "CVE-2019-9852"
    ]
  },
  "uno-libs3": {
    "4102-1": [
      "CVE-2019-9850",
      "CVE-2019-9851",
      "CVE-2019-9852"
    ]
  }
}

Running: snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages_0.1_amd64.snap'

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages_0.1_amd64.snap'

Running: snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages-needed_0.1_amd64.snap'
{
  "libreoffice-style-tango": [
    "4102-1"
  ],
  "uno-libs3": [
    "4102-1"
  ]
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages-needed_0.1_amd64.snap'
{
  "libreoffice-style-tango": {
    "4102-1": [
      "CVE-2019-9850",
      "CVE-2019-9851",
      "CVE-2019-9852"
    ]
  },
  "uno-libs3": {
    "4102-1": [
      "CVE-2019-9850",
      "CVE-2019-9851",
      "CVE-2019-9852"
    ]
  }
}

Running: snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages-needed_0.2_amd64.snap'
{
  "uno-libs3": [
    "4102-1"
  ]
}

Running: snap-updates-available --with-cves --usn-db='./tests/test-usn-unittest-lp1841848.db' --snap='./tests/test-check-notices-primed-stage-packages-needed_0.2_amd64.snap'
{
  "uno-libs3": {
    "4102-1": [
      "CVE-2019-9850",
      "CVE-2019-9851",
      "CVE-2019-9852"
    ]
  }
}

Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --store-db='./tests/test-store-unittest-lp1841848.db'

Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-lp1841848.db' --store-db='./tests/test-store-unittest-lp1841848-needed.db'
From: Snap Store <noreply@canonical.com>
To: test.me@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: test-snap contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r1 (amd64; channels: stable, edge)
 * libreoffice-style-tango: 4102-1
 * uno-libs3: 4102-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-4102-1/


Running: ./bin/snap-updates-available --usn-db='./tests/test-usn-unittest-1.db' --store-db='./tests/test-store-collaborators.db'
From: Snap Store <noreply@canonical.com>
To: olivier.tilloy@canonical.com, test.collaborator@example.com
Bcc: jamie@canonical.com, alex.murray@canonical.com, emilia.torino@canonical.com
Subject: 0ad contains outdated Ubuntu packages

A scan of this snap shows that it was built with packages from the Ubuntu
archive that have since received security updates. The following lists new
USNs for affected binary packages in each snap revision:

Revision r12 (i386; channels: stable, candidate, beta)
 * libtiff5: 3602-1, 3606-1
 * libxcursor1: 3501-1

Simply rebuilding the snap will pull in the new security updates and
resolve this. If your snap also contains vendored code, now might be a
good time to review it for any needed updates.

Thank you for your snap and for attending to this matter.

References:
 * https://ubuntu.com/security/notices/USN-3501-1/
 * https://ubuntu.com/security/notices/USN-3602-1/
 * https://ubuntu.com/security/notices/USN-3606-1/


Running: snap-check-notices --no-fetch ./tests/test-snapcraft-manifest_0_amd64.snap
{
  "test-snapcraft-manifest": {
    "0": {
      "libssl1.0.0": [
        "3611-1",
        "3628-1"
      ],
      "openssl": [
        "3611-1",
        "3628-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-snapcraft-manifest_0_amd64.snap
{
  "test-snapcraft-manifest": {
    "0": {
      "libssl1.0.0": {
        "3611-1": [
          "CVE-2018-0739"
        ],
        "3628-1": [
          "CVE-2018-0737"
        ]
      },
      "openssl": {
        "3611-1": [
          "CVE-2018-0739"
        ],
        "3628-1": [
          "CVE-2018-0737"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-budgie-3.db' snap-check-notices --no-fetch --with-cves ./tests/test-snapcraft-manifest-snapcraft-version_0_amd64.snap
{
  "test-snapcraft-manifest-snapcraft-version": {
    "0": {
      "libssl1.0.0": {
        "3611-1": [
          "CVE-2018-0739"
        ]
      },
      "openssl": {
        "3611-1": [
          "CVE-2018-0739"
        ]
      },
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/test-snapcraft-manifest-snapcraft-version-needed_0_amd64.snap
{
  "test-snapcraft-manifest-snapcraft-version-needed": {
    "0": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/test-snapcraft-manifest-package-in-installed-snaps_0_amd64.snap
{
  "test-snapcraft-manifest-package-in-installed-snaps": {
    "0": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/test-snapcraft-manifest-snapcraft-updated_0_amd64.snap
{
  "test-snapcraft-manifest-snapcraft-updated": {
    "0": {}
  }
}

Running: snap-check-notices --no-fetch ./tests/test-core_16-2.37.2_amd64.snap
{
  "test-core": {
    "16-2.37.2": {
      "libc-bin": [
        "3323-1",
        "3534-1"
      ],
      "multiarch-support": [
        "3323-1",
        "3534-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-core_16-2.37.2_amd64.snap
{
  "test-core": {
    "16-2.37.2": {
      "libc-bin": {
        "3323-1": [
          "CVE-2017-1000366"
        ],
        "3534-1": [
          "CVE-2017-1000408",
          "CVE-2017-1000409",
          "CVE-2017-15670",
          "CVE-2017-15804",
          "CVE-2017-16997",
          "CVE-2017-17426",
          "CVE-2018-1000001"
        ]
      },
      "multiarch-support": {
        "3323-1": [
          "CVE-2017-1000366"
        ],
        "3534-1": [
          "CVE-2017-1000408",
          "CVE-2017-1000409",
          "CVE-2017-15670",
          "CVE-2017-15804",
          "CVE-2017-16997",
          "CVE-2017-17426",
          "CVE-2018-1000001"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "linux-image-gke": [
        "4489-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "linux-image-gke": {
        "4489-1": [
          "CVE-2020-14386"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "linux-image-gke": [
        "4489-1"
      ],
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "linux-image-gke": {
        "4489-1": [
          "CVE-2020-14386"
        ]
      },
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1027.28~16.04.1_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1027.28~16.04.1": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "linux-image-generic": [
        "3848-1",
        "3879-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "linux-image-generic": {
        "3848-1": [
          "CVE-2017-18174",
          "CVE-2018-12896",
          "CVE-2018-18690",
          "CVE-2018-18710"
        ],
        "3879-1": [
          "CVE-2018-10883",
          "CVE-2018-16862",
          "CVE-2018-19407",
          "CVE-2018-19824",
          "CVE-2018-20169"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "linux-image-generic": [
        "3848-1",
        "3879-1"
      ],
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "linux-image-generic": {
        "3848-1": [
          "CVE-2017-18174",
          "CVE-2018-12896",
          "CVE-2018-18690",
          "CVE-2018-18710"
        ],
        "3879-1": [
          "CVE-2018-10883",
          "CVE-2018-16862",
          "CVE-2018-19407",
          "CVE-2018-19824",
          "CVE-2018-20169"
        ]
      },
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch --with-cves ./tests/linux-generic-bbb_4.4.0-140-1_armhf.snap
{
  "linux-generic-bbb": {
    "4.4.0-140-1": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "linux-image-generic": [
        "3871-2",
        "4489-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "linux-image-generic": {
        "3871-2": [
          "https://launchpad.net/bugs/1813663",
          "https://launchpad.net/bugs/1813727"
        ],
        "4489-1": [
          "CVE-2020-14386"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "linux-image-generic": [
        "3871-2",
        "4489-1"
      ],
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "linux-image-generic": {
        "3871-2": [
          "https://launchpad.net/bugs/1813663",
          "https://launchpad.net/bugs/1813727"
        ],
        "4489-1": [
          "CVE-2020-14386"
        ]
      },
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.15.0-44.46_i386.snap
{
  "pc-kernel": {
    "4.15.0-44.46": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "linux-image-generic": [
        "3879-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "linux-image-generic": {
        "3879-1": [
          "CVE-2018-10883",
          "CVE-2018-16862",
          "CVE-2018-19407",
          "CVE-2018-19824",
          "CVE-2018-20169"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "linux-image-generic": [
        "3879-1"
      ],
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "linux-image-generic": {
        "3879-1": [
          "CVE-2018-10883",
          "CVE-2018-16862",
          "CVE-2018-19407",
          "CVE-2018-19824",
          "CVE-2018-20169"
        ]
      },
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch --with-cves ./tests/pc-kernel_4.4.0-141.167_amd64.snap
{
  "pc-kernel": {
    "4.4.0-141.167": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {}
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {}
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-kernel-and-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": [
        "5501-1"
      ]
    }
  }
}

Running: USNDB='./tests/test-usn-unittest-build-pkgs-only.db' snap-check-notices --no-fetch --with-cves ./tests/gke-kernel_4.15.0-1069.72_amd64.snap
{
  "gke-kernel": {
    "4.15.0-1069.72": {
      "snapcraft": {
        "5501-1": [
          "CVE-2020-9999"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/test-check-notices_0.1_amd64.snap
{
  "test-check-notices": {
    "0.1": {}
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-check-notices_0.1_amd64.snap
{
  "test-check-notices": {
    "0.1": {}
  }
}

Running: snap-check-notices --no-fetch ./tests/test-check-notices-needed_0.1_amd64.snap
{
  "test-check-notices-needed": {
    "0.1": {
      "libreoffice-style-tango": [
        "4102-1"
      ],
      "uno-libs3": [
        "4102-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-check-notices-needed_0.1_amd64.snap
{
  "test-check-notices-needed": {
    "0.1": {
      "libreoffice-style-tango": {
        "4102-1": [
          "CVE-2019-9850",
          "CVE-2019-9851",
          "CVE-2019-9852"
        ]
      },
      "uno-libs3": {
        "4102-1": [
          "CVE-2019-9850",
          "CVE-2019-9851",
          "CVE-2019-9852"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/test-check-notices-primed-stage-packages_0.1_amd64.snap
{
  "test-check-notices-primed-stage-packages": {
    "0.1": {}
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-check-notices-primed-stage-packages_0.1_amd64.snap
{
  "test-check-notices-primed-stage-packages": {
    "0.1": {}
  }
}

Running: snap-check-notices --no-fetch ./tests/test-check-notices-primed-stage-packages-needed_0.1_amd64.snap
{
  "test-check-notices-primed-stage-packages-needed": {
    "0.1": {
      "libreoffice-style-tango": [
        "4102-1"
      ],
      "uno-libs3": [
        "4102-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-check-notices-primed-stage-packages-needed_0.1_amd64.snap
{
  "test-check-notices-primed-stage-packages-needed": {
    "0.1": {
      "libreoffice-style-tango": {
        "4102-1": [
          "CVE-2019-9850",
          "CVE-2019-9851",
          "CVE-2019-9852"
        ]
      },
      "uno-libs3": {
        "4102-1": [
          "CVE-2019-9850",
          "CVE-2019-9851",
          "CVE-2019-9852"
        ]
      }
    }
  }
}

Running: snap-check-notices --no-fetch ./tests/test-check-notices-primed-stage-packages-needed_0.2_amd64.snap
{
  "test-check-notices-primed-stage-packages-needed": {
    "0.2": {
      "uno-libs3": [
        "4102-1"
      ]
    }
  }
}

Running: snap-check-notices --no-fetch --with-cves ./tests/test-check-notices-primed-stage-packages-needed_0.2_amd64.snap
{
  "test-check-notices-primed-stage-packages-needed": {
    "0.2": {
      "uno-libs3": {
        "4102-1": [
          "CVE-2019-9850",
          "CVE-2019-9851",
          "CVE-2019-9852"
        ]
      }
    }
  }
}

